@model HotelBooking.ViewModels.HotelDetailsViewModel
@{
    ViewData["Title"] = Model.Name;
}

<!-- Image Grid (Airbnb Style) -->
<div class="max-w-7xl mx-auto pt-6 pb-8">
    <div class="grid grid-cols-4 grid-rows-2 gap-2 h-[400px] md:h-[500px] rounded-xl overflow-hidden">
        <!-- Main Image -->
        <div class="col-span-4 md:col-span-2 row-span-2 relative group cursor-pointer">
            <div class="absolute inset-0 bg-black/10 group-hover:bg-transparent transition-colors"></div>
            @if (!string.IsNullOrEmpty(Model.ImageUrl))
            {
                <img src="@Model.ImageUrl" alt="@Model.Name" class="w-full h-full object-cover" />
            }
            else
            {
                <div class="w-full h-full bg-gray-200 flex items-center justify-center">
                    <span class="text-gray-400 font-medium">No Image</span>
                </div>
            }
        </div>
        <!-- Grid Images (Placeholders for now as model only has one URL) -->
        <div class="hidden md:block col-span-1 row-span-1 relative bg-gray-100"><img src="https://images.unsplash.com/photo-1578683010236-d716f9a3f461?auto=format&fit=crop&w=400&q=80" class="w-full h-full object-cover hover:opacity-95 transition-opacity" /></div>
        <div class="hidden md:block col-span-1 row-span-1 relative bg-gray-100"><img src="https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?auto=format&fit=crop&w=400&q=80" class="w-full h-full object-cover hover:opacity-95 transition-opacity" /></div>
        <div class="hidden md:block col-span-1 row-span-1 relative bg-gray-100"><img src="https://images.unsplash.com/photo-1566665797739-1674de7a421a?auto=format&fit=crop&w=400&q=80" class="w-full h-full object-cover hover:opacity-95 transition-opacity" /></div>
        <div class="hidden md:block col-span-1 row-span-1 relative bg-gray-100"><img src="https://images.unsplash.com/photo-1598928506311-c55ded91a20c?auto=format&fit=crop&w=400&q=80" class="w-full h-full object-cover hover:opacity-95 transition-opacity" /></div>
    </div>
</div>

<div class="max-w-7xl mx-auto px-4 lg:px-0">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
        <!-- Left Column: Details -->
        <div class="lg:col-span-2">
            <!-- Header -->
            <div class="border-b border-gray-200 pb-6 mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">@Model.Name</h1>
                <p class="text-gray-600 text-lg mb-2">@Model.Address, @Model.City, @Model.Country</p>
                
                <div class="flex items-center gap-4 text-sm mt-3">
                    <div class="flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-primary fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>
                        <span class="font-bold">@Model.AverageRating.ToString("F1")</span>
                        <span class="underline cursor-pointer">@Model.Reviews.Count() reviews</span>
                    </div>
                    <span>‚Ä¢</span>
                    <span class="badge badge-outline badge-sm text-xs">@Model.StarRating Star Hotel</span>
                    @if (!string.IsNullOrEmpty(Model.Website))
                    {
                        <span>‚Ä¢</span>
                        <a href="@Model.Website" target="_blank" class="link link-hover text-gray-500">Website</a>
                    }
                </div>
            </div>

            <!-- Description -->
            <div class="py-6 border-b border-gray-200">
                <div class="prose max-w-none text-gray-700">
                    <p class="leading-relaxed">@Model.Description</p>
                </div>
            </div>

            <!-- Amenities -->
            <div class="py-8 border-b border-gray-200">
                <h2 class="text-xl font-bold mb-4">What this place offers</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div class="flex items-center gap-3 text-gray-600"><span class="w-6 text-center text-xl">üì∂</span> Wifi</div>
                    <div class="flex items-center gap-3 text-gray-600"><span class="w-6 text-center text-xl">üÖøÔ∏è</span> Free parking</div>
                    <div class="flex items-center gap-3 text-gray-600"><span class="w-6 text-center text-xl">‚ùÑÔ∏è</span> Air conditioning</div>
                    <div class="flex items-center gap-3 text-gray-600"><span class="w-6 text-center text-xl">üç≥</span> Kitchen</div>
                    <div class="flex items-center gap-3 text-gray-600"><span class="w-6 text-center text-xl">üì∫</span> TV</div>
                    <div class="flex items-center gap-3 text-gray-600"><span class="w-6 text-center text-xl">üß∫</span> Washer</div>
                </div>
            </div>

            <!-- Available Rooms -->
            <div class="py-8">
                <h2 class="text-2xl font-bold mb-6">Choose your room</h2>
                
                @if (!Model.RoomTypes.Any())
                {
                    <div class="alert alert-warning">No rooms available for these dates.</div>
                }
                else
                {
                    <div class="space-y-8">
                        @foreach (var roomType in Model.RoomTypes)
                        {
                            <div class="bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow">
                                <div class="p-6">
                                    <div class="flex justify-between items-start mb-4">
                                        <div>
                                            <h3 class="text-xl font-bold">@roomType.Name</h3>
                                            <p class="text-gray-500 mt-1">@roomType.Description</p>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-2xl font-bold block">@roomType.BasePrice.ToString("N0")‚Ç´</span>
                                            <span class="text-gray-500 text-sm">per night</span>
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                                        @foreach (var room in roomType.AvailableRooms.Take(3))
                                        {
                                            <div class="border rounded-lg p-4 flex justify-between items-center group hover:border-primary transition-colors cursor-default">
                                                <div>
                                                    <div class="font-medium">Room @room.RoomNumber</div>
                                                    <div class="text-xs text-gray-500">Floor @room.Floor</div>
                                                </div>
                                                <a asp-controller="Booking" asp-action="Create"
                                                   asp-route-roomId="@room.RoomId"
                                                   asp-route-checkIn="@Model.CheckInDate.ToString("yyyy-MM-dd")"
                                                   asp-route-checkOut="@Model.CheckOutDate.ToString("yyyy-MM-dd")"
                                                   asp-route-guests="@Model.Guests"
                                                   class="btn btn-primary btn-sm rounded-lg px-6">
                                                    Reserve
                                                </a>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
            </div>
            
            <!-- Reviews -->
            @if (Model.Reviews.Any())
            {
                <div class="py-8 border-t border-gray-200">
                    <h2 class="text-2xl font-bold mb-8">‚≠ê @Model.AverageRating.ToString("F1") ¬∑ @Model.Reviews.Count() reviews</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        @foreach (var review in Model.Reviews)
                        {
                            <div>
                                <div class="flex items-center gap-3 mb-3">
                                    <div class="avatar placeholder">
                                        <div class="bg-neutral text-neutral-content rounded-full w-10">
                                            <span>@review.UserName.Substring(0,1)</span>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="font-bold">@review.UserName</div>
                                        <div class="text-xs text-gray-500">@review.CreatedDate.ToString("MMM yyyy")</div>
                                    </div>
                                </div>
                                <div class="rating rating-xs disabled mb-2">
                                     @for (int i = 1; i <= 5; i++)
                                     {
                                         <input type="radio" class="mask mask-star-2 bg-black" disabled checked="@(i <= review.Rating)" />
                                     }
                                </div>
                                <p class="text-gray-700">@review.Comment</p>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>

        <!-- Right Column: Sticky Sidebar -->
        <div class="hidden lg:block">
            <div class="sticky top-28">
                <div class="card bg-white border border-gray-200 shadow-xl rounded-2xl overflow-hidden">
                    <div class="card-body p-6">
                        <div class="flex justify-between items-end mb-4">
                            <div>
                                <span class="text-2xl font-bold text-gray-900">Check availability</span>
                            </div>
                        </div>

                        <div class="border rounded-xl mb-4 overflow-hidden">
                            <div class="grid grid-cols-2 border-b">
                                <div class="p-3 border-r">
                                    <label class="block text-xs font-bold uppercase text-gray-700">Check-in</label>
                                    <div class="text-gray-600">@Model.CheckInDate.ToString("dd/MM/yyyy")</div>
                                </div>
                                <div class="p-3">
                                    <label class="block text-xs font-bold uppercase text-gray-700">Check-out</label>
                                    <div class="text-gray-600">@Model.CheckOutDate.ToString("dd/MM/yyyy")</div>
                                </div>
                            </div>
                            <div class="p-3">
                                <label class="block text-xs font-bold uppercase text-gray-700">Guests</label>
                                <div class="text-gray-600">@Model.Guests guests</div>
                            </div>
                        </div>

                        <a href="#available-rooms" onclick="document.querySelector('.space-y-8').scrollIntoView({behavior: 'smooth'})" class="btn btn-primary w-full btn-lg rounded-xl text-lg font-bold">
                            Check availability
                        </a>
                        
                        <div class="text-center mt-4 text-gray-500 text-sm">
                            You won't be charged yet
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-center gap-2 text-gray-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-8a2 2 0 012-2h14a2 2 0 012 2v8M12 21V9m-9 12a2 2 0 002 2h14a2 2 0 002-2" /></svg>
                    <span class="text-xs">Report this listing</span>
                </div>
            </div>
        </div>
    </div>
</div>
